<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Hayley&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hayley&#39;s Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hayley&#39;s Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Hayley's Blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hayley's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/25/webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/25/webpack/" itemprop="url">webpack</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-25T14:18:52+08:00">
                2019-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://github.com/Liuhui11/homework/tree/master/webpack-learn" target="_blank" rel="external">项目github地址</a></p>
<h2 id="从0配置项目"><a href="#从0配置项目" class="headerlink" title="从0配置项目"></a>从0配置项目</h2><ul>
<li>安装webpack ==推荐局部安装==</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># node版本</div><div class="line">v10<span class="number">.16</span><span class="number">.0</span></div><div class="line"># 安装最新的稳定版本 </div><div class="line">npm i -D webpack</div><div class="line"># 安装指定版本</div><div class="line">npm i -D webpack@&lt;version&gt;</div><div class="line"># 安装最新的体验版本 可能包含bug,不不要⽤用于⽣生产环境</div><div class="line">npm i -D webpack@beta</div><div class="line"># 安装webpack V4+版本时，需要额外安装webpack-cli </div><div class="line">npm i -D webpack-cli</div></pre></td></tr></table></figure>
<ul>
<li>检查安装</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">webpack -v  <span class="comment">//command not found 默认在全局环境中查找</span></div><div class="line"># 安装npx</div><div class="line">npm install -g npx</div><div class="line">npx webpack -v  <span class="comment">//npx帮助我们在项⽬目中的node_modules⾥里里查找webpack </span></div><div class="line">./node_modules/.bin/webpack -v <span class="comment">//到当前的node_modules模块⾥里里指定 webpack</span></div></pre></td></tr></table></figure>
<ul>
<li>启动构建</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># npx方式</div><div class="line">npx webpack</div><div class="line"># npm script</div><div class="line">npm run test</div><div class="line"># 修改package.json</div><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">  <span class="string">"test"</span>: <span class="string">"webpack"</span> <span class="comment">// 原理理就是通过shell脚本在node_modules/.bin⽬目录下创建⼀一个软链接。</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul>
<li>entry 入口</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//单⼊入⼝口 SPA，本质是个字符串串 </span></div><div class="line">entry:&#123;</div><div class="line">  main: <span class="string">'./src/index.js'</span></div><div class="line">&#125;</div><div class="line">==相当于简写=== entry:<span class="string">"./src/index.js"</span></div><div class="line"><span class="comment">// 一个出口，从右至左合并</span></div><div class="line">entry: [<span class="string">"./src/index.js"</span>, <span class="string">"./src/login.js"</span>] </div><div class="line"><span class="comment">//多⼊入⼝口 entry是个对象 </span></div><div class="line">entry:&#123;</div><div class="line">  index: <span class="string">"./src/index.js"</span>,</div><div class="line">  login: <span class="string">"./src/login.js"</span></div><div class="line">&#125;</div><div class="line"><span class="string">``</span><span class="string">`js</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">- output 出口</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">`</span><span class="string">``</span>js</div><div class="line">output: &#123;</div><div class="line">  filename: <span class="string">"bundle.js"</span>, <span class="comment">//输出⽂文件的名称</span></div><div class="line">  path: path.resolve(__dirname,<span class="string">"dist"</span>) <span class="comment">//输出⽂文件到磁盘的⽬目录，必须是绝对路路径</span></div><div class="line">&#125;,</div><div class="line"></div><div class="line"><span class="comment">//多⼊入⼝口的处理理 </span></div><div class="line">output: &#123;</div><div class="line">  filename: <span class="string">"[name][chunkhash:8].js"</span>, <span class="comment">//利利⽤用占位符，⽂件名称不会要重复</span></div><div class="line">  path: path.resolve(__dirname,<span class="string">"dist"</span>) <span class="comment">//输出⽂文件到磁盘的⽬目录，必 须是绝对路路径</span></div><div class="line">&#125;,</div><div class="line"># 模式</div><div class="line">hash <span class="comment">//改变每个bundle文件的hash值</span></div><div class="line">chunkhash <span class="comment">//只改变修改了代码对应文件的hash值</span></div><div class="line">contenthash <span class="comment">//改变js中引入css代码，只改变css的hash值</span></div></pre></td></tr></table></figure>
<ul>
<li>mode 打包模式<ul>
<li>production</li>
<li>development</li>
<li>none</li>
</ul>
</li>
</ul>
<h3 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h3><ul>
<li>css处理</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用dart-sass 跨平台</span></div><div class="line">npm style-loader css-loader sass-loader sass -D</div><div class="line"></div><div class="line"><span class="comment">// 修改loader配置</span></div><div class="line">&#123;</div><div class="line">    test: <span class="regexp">/\.(sass|scss)/</span>,</div><div class="line">    use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, &#123;</div><div class="line">        loader: <span class="string">'sass-loader'</span>,</div><div class="line">        options: &#123;</div><div class="line">            implementation: <span class="built_in">require</span>(<span class="string">'sass'</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>文件处理</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 安装</span></div><div class="line">npm i file-loader -D</div><div class="line"><span class="comment">// 修改配置</span></div><div class="line">&#123;</div><div class="line">    test: <span class="regexp">/\.(png|jpg|jpeg|gif)$/</span>,</div><div class="line">    use: [</div><div class="line">        &#123;</div><div class="line">            loader: <span class="string">'file-loader'</span>,</div><div class="line">            options: &#123;</div><div class="line">                name: <span class="string">'[name].[ext]'</span>,</div><div class="line">                outputPath: <span class="string">'images/'</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">npm i html-webpack-plugin clean-webpack-plugin -D</div><div class="line"></div><div class="line">plugins: [</div><div class="line">    <span class="keyword">new</span> htmlWebpackPlugin(&#123;</div><div class="line">        title: <span class="string">'test page'</span>,</div><div class="line">        filename: <span class="string">'test.html'</span>,</div><div class="line">        template: <span class="string">'index.html'</span></div><div class="line">    &#125;),</div><div class="line">    <span class="keyword">new</span> CleanWebpackPlugin()</div><div class="line">]</div></pre></td></tr></table></figure>
<h3 id="sourceMap"><a href="#sourceMap" class="headerlink" title="sourceMap"></a>sourceMap</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 通过devtool选项控制是否以及如何生成source map</span></div><div class="line">devtool: <span class="string">'source-map'</span>,</div></pre></td></tr></table></figure>
<h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><h3 id="自定义脚本"><a href="#自定义脚本" class="headerlink" title="自定义脚本"></a>自定义脚本</h3><p>每当执行npm run，就会自动新建一个shell，在这个shell里面执行指定的脚本命令，会将当前目录的node_modules/.bin子目录加入PATH变量，所以.bin子目录里面所有脚本可以不加路径直接调用</p>
<h3 id="脚本执行顺序"><a href="#脚本执行顺序" class="headerlink" title="脚本执行顺序"></a>脚本执行顺序</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 并行执行(即同时的平⾏行行执⾏行行)，可以使⽤用 &amp; 符号</span></div><div class="line">$ npm run script1.js &amp; npm run script2.js</div><div class="line"><span class="comment">// 继发执⾏行行(即只有前⼀一个任务成功，才执⾏行行下⼀一个任务)，可以使⽤用 &amp;&amp; 符号</span></div><div class="line">$ npm run script1.js &amp;&amp; npm run script2.js</div></pre></td></tr></table></figure>
<h3 id="常用脚本命令"><a href="#常用脚本命令" class="headerlink" title="常用脚本命令"></a>常用脚本命令</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 删除⽬目录</span></div><div class="line"><span class="string">"clean"</span>: <span class="string">"rimraf dist/*"</span>,</div><div class="line"><span class="comment">// 本地搭建⼀一个 HTTP 服务</span></div><div class="line"><span class="string">"serve"</span>: <span class="string">"http-server -p 9090 dist/"</span>,</div><div class="line"><span class="comment">// 打开浏览器器</span></div><div class="line"><span class="string">"open:dev"</span>: <span class="string">"opener http://localhost:9090"</span>,</div><div class="line"><span class="comment">// 实时刷新</span></div><div class="line"><span class="string">"livereload"</span>: <span class="string">"live-reload --port 9091 dist/"</span>,</div><div class="line"><span class="comment">// 构建 HTML ⽂文件</span></div><div class="line"><span class="string">"build:html"</span>: <span class="string">"jade index.jade &gt; dist/index.html"</span>,</div><div class="line"><span class="comment">// 只要 CSS ⽂文件有变动，就重新执⾏行行构建</span></div><div class="line"><span class="string">"watch:css"</span>: <span class="string">"watch 'npm run build:css' assets/styles/"</span>, </div><div class="line"><span class="comment">// 只要 HTML ⽂文件有变动，就重新执⾏行行构建</span></div><div class="line"><span class="string">"watch:html"</span>: <span class="string">"watch 'npm run build:html' assets/html"</span>, </div><div class="line"><span class="comment">// 构建 favicon</span></div><div class="line"><span class="string">"build:favicon"</span>: <span class="string">"node scripts/favicon.js"</span>,</div></pre></td></tr></table></figure>
<h3 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"bin"</span>: &#123;</div><div class="line">        <span class="string">"test"</span>: <span class="string">"./index.js"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">## index.js</div><div class="line">    #!<span class="regexp">/usr/</span>bin/env node <span class="comment">// 文件头部必须要有此行</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'执行成功'</span>) <span class="comment">// 执行test会打印“执行成功”</span></div></pre></td></tr></table></figure>
<h2 id="打包优化"><a href="#打包优化" class="headerlink" title="打包优化"></a>打包优化</h2><h3 id="webpackDevServer"><a href="#webpackDevServer" class="headerlink" title="webpackDevServer"></a>webpackDevServer</h3><h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><h3 id="热更新替换HRM"><a href="#热更新替换HRM" class="headerlink" title="热更新替换HRM"></a>热更新替换HRM</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">devServer: &#123;</div><div class="line">    contentBase: './dist',</div><div class="line">    port: 8080,</div><div class="line">    hot: true, // 开启热更新，css代码修改浏览器不刷新页面更新</div><div class="line">    hotOnly: true // 热更新浏览器也不刷新页面</div><div class="line">&#125;,</div><div class="line"></div><div class="line"># 处理js模块HMR</div><div class="line">...</div></pre></td></tr></table></figure>
<h3 id="Babel处理ES6"><a href="#Babel处理ES6" class="headerlink" title="Babel处理ES6"></a>Babel处理ES6</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 安装babel依赖包</span></div><div class="line">npm install -D babel-loader @babel/core @babel/preset-env</div><div class="line">&#123;</div><div class="line">    test: <span class="regexp">/\.js$/</span>,</div><div class="line">    exclude: <span class="regexp">/node_modules/</span>,</div><div class="line">    use: &#123;</div><div class="line">        loader: <span class="string">'babel-loader'</span>,</div><div class="line">        options: &#123;</div><div class="line">            presents: [<span class="string">'@babel/present-env'</span>,</div><div class="line">                &#123;</div><div class="line">                    targets: &#123;</div><div class="line">                        edge: <span class="string">"17"</span>,</div><div class="line">                        firefox: <span class="string">"60"</span>,</div><div class="line">                        chrome: <span class="string">"67"</span>,</div><div class="line">                        safari: <span class="string">"11.1"</span></div><div class="line">                    &#125;,</div><div class="line">                    corejs: <span class="number">2</span>, <span class="comment">//新版本需要指定核⼼心库版本</span></div><div class="line">                    useBuiltIns: <span class="string">"usage"</span> <span class="comment">//按需注⼊!!!</span></div><div class="line">                &#125;</div><div class="line">            ],</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 开发工具库、组件库场景时，把es的新特性都装进来，弥补低版本浏览器的兼容问题</span></div><div class="line">npm install --save-dev @babel/plugin-transform-runtime</div><div class="line">npm install --save @babel/runtime</div><div class="line">&#123;</div><div class="line">    test: <span class="regexp">/\.js$/</span>,</div><div class="line">    exclude: <span class="regexp">/node_modules/</span>,</div><div class="line">    use: &#123;</div><div class="line">        loader: <span class="string">'babel-loader'</span>,</div><div class="line">        options: &#123;</div><div class="line">            <span class="comment">// presents: ['@babel/present-env'],</span></div><div class="line">            plugins: [<span class="string">'@babel/plugin-transform-runtime'</span>,</div><div class="line">                &#123;</div><div class="line">                    <span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</div><div class="line">                    <span class="string">"corejs"</span>: <span class="literal">false</span>,</div><div class="line">                    <span class="string">"helpers"</span>: <span class="literal">true</span>,</div><div class="line">                    <span class="string">"regenerator"</span>: <span class="literal">true</span>,</div><div class="line">                    <span class="string">"useESModules"</span>: <span class="literal">false</span></div><div class="line">                &#125;</div><div class="line">            ]</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="代码分割"><a href="#代码分割" class="headerlink" title="代码分割"></a>代码分割</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// https://webpack.js.org/plugins/split-chunks-plugin/</span></div><div class="line">optimization: &#123;</div><div class="line">    splitChunks: &#123;</div><div class="line">        chunks: <span class="string">"all"</span>, <span class="comment">// 所有的chunks代码公共的部分分离出来成为⼀一个 单独的⽂文件</span></div><div class="line">    &#125;,</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h3 id="执行并发任务happypack"><a href="#执行并发任务happypack" class="headerlink" title="执行并发任务happypack"></a>执行并发任务happypack</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 运行在node之上的webpack是单线程模型的，happypack可以使webapck执行多任务</span></div></pre></td></tr></table></figure>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">tree shaking 移除javascript上下文中未引用代码</div><div class="line">HRM 模块热替换</div><div class="line">模块解析 https:<span class="comment">//webpack.docschina.org/concepts/module-resolution/</span></div></pre></td></tr></table></figure>
<h2 id="创造"><a href="#创造" class="headerlink" title="创造"></a>创造</h2><h3 id="如何自己编写一个Plugin"><a href="#如何自己编写一个Plugin" class="headerlink" title="如何自己编写一个Plugin"></a>如何自己编写一个Plugin</h3><p><a href="https://webpack.js.org/contribute/writing-a-plugin/" target="_blank" rel="external">https://webpack.js.org/contribute/writing-a-plugin/</a></p>
<h3 id="如何自己编写一个Loader"><a href="#如何自己编写一个Loader" class="headerlink" title="如何自己编写一个Loader"></a>如何自己编写一个Loader</h3><p>插件向第三方开发者提供了webpack引擎中完整的能力</p>
<ul>
<li><a href="https://webpack.js.org/contribute/writing-a-loader/" target="_blank" rel="external">https://webpack.js.org/contribute/writing-a-loader/</a></li>
<li><a href="https://webpack.js.org/api/compiler-hooks/" target="_blank" rel="external">https://webpack.js.org/api/compiler-hooks/</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/17/create-cli/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/17/create-cli/" itemprop="url">创建一个自己的脚手架</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-17T15:18:52+08:00">
                2019-11-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://juejin.im/post/5c94fef7f265da60fd0c15e8" target="_blank" rel="external">如何创建自己的脚手架详细教程</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">总结：</div><div class="line"><span class="number">1.</span> 相关写命令的插件</div><div class="line"><span class="number">2.</span> 如何写命令 (bin使用)</div><div class="line"><span class="number">3.</span> 创建自己的项目模板（参考vue-template-webpack）</div><div class="line"><span class="number">4.</span> 思考工作中有哪些重复的操作可以写一个脚手架或者命令来完成？</div><div class="line">- 项目架构组内共享</div><div class="line">- 组内私有npm仓库</div><div class="line">- 创建一个新的功能模块（复制公共模块模板）</div><div class="line"></div><div class="line">想法-微前端架构-每个组把自己的架构上传到npm</div><div class="line">- 根据不同的组名下载对应的模板（每个组件有对应的目录直接下载）</div><div class="line">- 根据不同交互设置选择相应的文件或者配置（类似通过问题-答案生成最终的目录）</div><div class="line"></div><div class="line"><span class="number">5.</span> npm发布脚本</div><div class="line"><span class="meta">#!/usr/bin/env bash</span></div><div class="line">npm config get registry # 检查仓库镜像库</div><div class="line">npm config set registry=http:<span class="comment">//registry.npmjs.org</span></div><div class="line">echo <span class="string">'请进行登录相关操作：'</span></div><div class="line">npm login # 登陆</div><div class="line">echo <span class="string">"-------publishing-------"</span></div><div class="line">npm publish # 发布</div><div class="line">npm config set registry=https:<span class="comment">//registry.npm.taobao.org # 设置为淘宝镜像</span></div><div class="line">echo <span class="string">"发布完成"</span></div><div class="line">exit</div><div class="line"></div><div class="line">修改权限 chmod +x bin<span class="comment">/*</span></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/05/vuex/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/05/vuex/" itemprop="url">vuex</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-05T09:53:37+08:00">
                2019-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="核心点"><a href="#核心点" class="headerlink" title="核心点"></a>核心点</h3><ol>
<li><p>概念</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">state 状态树</div><div class="line">getters 派生状态 对应组件computed</div><div class="line">mutations 修改state执行commit 对应组件methods 同步操作方便跟踪state</div><div class="line">action dispatch执行mutations 对应组件methods 处理复杂业务逻辑/异步操作</div></pre></td></tr></table></figure>
</li>
<li><p>vuex使用以及模块化</p>
</li>
<li><p>应用场景</p>
<ul>
<li>数据源不统一，可能导致不同地方显示数据有冲突</li>
<li>多个地方可以复用同一数据</li>
</ul>
</li>
<li><p>复杂vuex设计</p>
<p> <strong>思维：从界面推导数据，从具体到抽象</strong></p>
<p> <a href="https://zhuanlan.zhihu.com/p/28002027" target="_blank" rel="external">vuex数据管理</a></p>
<p> <a href="https://www.jianshu.com/p/cf802cf90cab" target="_blank" rel="external">vuex数据管理社区解决方案：vuex-orm插件</a></p>
<p> <a href="https://www.jianshu.com/p/a971cc324cd7" target="_blank" rel="external"><strong>==扩展：复杂web应用的状态管理(各种方案对比以及演进)==</strong></a></p>
</li>
<li><p>vuex单元测试</p>
<p> <a href="https://blog.jimmylv.info/2018-11-02-vue-application-unit-test-strategy-and-practice-04-testing-vuex/" target="_blank" rel="external">vuex如何写单元测试</a></p>
</li>
</ol>
<hr>
<h3 id="待探索内容"><a href="#待探索内容" class="headerlink" title="待探索内容"></a>待探索内容</h3><ol>
<li>vuex单元测试</li>
<li>复杂vuex数据设计（看佣金测算的功能）</li>
<li>vuex源码</li>
<li>vuex应用demo整理</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/04/hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/04/hexo/" itemprop="url">hexo博客系统使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-04T17:24:15+08:00">
                2019-11-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="博客分类"><a href="#博客分类" class="headerlink" title="博客分类"></a>博客分类</h3><ul>
<li>框架<ul>
<li>vue</li>
<li>react</li>
</ul>
</li>
<li>js</li>
<li>css</li>
<li>html5</li>
<li>node</li>
<li>架构</li>
<li>算法</li>
<li>工程化<ul>
<li>webpack</li>
<li>gulp/grunt</li>
</ul>
</li>
<li>通用技能</li>
<li>英语</li>
<li>音乐</li>
</ul>
<h3 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h3><p><a href="https://zhuanlan.zhihu.com/p/26625249" target="_blank" rel="external">GitHub+Hexo搭建个人网站详细教程</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">npm install hexo-deployer-git --save 关联Hexo和Github</div><div class="line"></div><div class="line">常用命令：</div><div class="line">- hexo s 启动服务 srever</div><div class="line">- hexo g 生成内容 generate</div><div class="line">- hexo d 部署 deploy</div><div class="line">- hexo clean 更新文章前先清一下缓存</div><div class="line">- hexo new page 新建页面</div><div class="line">- hexo new tag/categories 新建标签、分类</div></pre></td></tr></table></figure>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><ul>
<li>Typora markdown编辑器<ul>
<li>绘制流程图 Flowchart</li>
<li>绘制时序图 Sequence Diagram</li>
</ul>
</li>
<li>Process 在线画各种流程图</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/04/vue-router/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/04/vue-router/" itemprop="url">vue-router</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-11-04T10:53:37+08:00">
                2019-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、使用"><a href="#一、使用" class="headerlink" title="一、使用"></a>一、使用</h3><p>配置 router.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; path: &apos;/&apos;, name: &apos;home&apos;, component: Home &#125;</div></pre></td></tr></table></figure>
<p>路由出口 App.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;router-view/&gt;</div></pre></td></tr></table></figure>
<p>导航链接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;router-link to=&quot;/&quot;&gt;Home&lt;/router-link&gt;</div><div class="line">&lt;router-link to=&quot;/about&quot;&gt;About&lt;/router-link&gt;</div></pre></td></tr></table></figure>
<p>添加到vue实例 main.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">new Vue(&#123;</div><div class="line">    router,</div><div class="line">&#125;).$mount(&apos;#app&apos;)</div></pre></td></tr></table></figure>
<p>动态路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    path: &apos;/detail/:id&apos;,</div><div class="line">    name: &apos;detail&apos;,</div><div class="line">    component: Detail</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>嵌套路由</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    path: &apos;/&apos;,</div><div class="line">    name: &apos;home&apos;,</div><div class="line">    component: Home,</div><div class="line">    children: [&#123; // 记得添加视图入口router-view</div><div class="line">        path: &apos;/detail/:id&apos;,</div><div class="line">        name: &apos;detail&apos;,</div><div class="line">        component: Detail</div><div class="line">    &#125;] </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="二、工作流程图"><a href="#二、工作流程图" class="headerlink" title="二、工作流程图"></a>二、工作流程图</h3><p><img src="http://assets.processon.com/chart_image/5ab08d8ae4b056c700737a84.png" alt="image"></p>
<h3 id="三、原理"><a href="#三、原理" class="headerlink" title="三、原理"></a>三、原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">vue-router有三种模式：</div><div class="line">hash</div><div class="line">history（需要配合服务端配置使用）</div><div class="line">abstract（node环境强制使用）</div><div class="line"></div><div class="line">原理：</div><div class="line">pushState()/replaceState()：往浏览器添加历史记录</div><div class="line">popstste事件：用户点击浏览器前进/返回，或调用history的back()、go()方法时触发</div><div class="line"></div><div class="line">使用h5 History对象的特性，浏览器会把页面存储在历史记录栈里面，</div><div class="line">使用history的back()、go()等方法改变当前战士哪个页面并不会刷新页面。</div></pre></td></tr></table></figure>
<p>简易版功能实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">let Vue;</div><div class="line">// 声明Router类</div><div class="line">class VueRouter &#123;</div><div class="line">    constructor(options) &#123;</div><div class="line">        this.$options = options;</div><div class="line">        this.routeMap = &#123;&#125;;</div><div class="line"></div><div class="line">        // url响应式处理</div><div class="line">        this.app = new Vue(&#123;</div><div class="line">            data: &#123;</div><div class="line">                current: &apos;/&apos;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    init() &#123;</div><div class="line">        this.bindEvents();</div><div class="line">        this.createRouteMap();</div><div class="line">        this.initComponent();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 创建路由映射表</div><div class="line">    createRouteMap() &#123;</div><div class="line">        this.$options.routes.forEach((item) =&gt; &#123;</div><div class="line">            this.routeMap[item.path] = item;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 监听hash值变化</div><div class="line">    bindEvents() &#123;</div><div class="line">        window.addEventListener(&apos;load&apos;, this.onHashChange.bind(this));</div><div class="line">        window.addEventListener(&apos;hashchange&apos;, this.onHashChange.bind(this));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    onHashChange() &#123;</div><div class="line">        this.app.current = window.location.hash.slice(1) || &apos;/&apos;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    initComponent() &#123;</div><div class="line">        Vue.component(&apos;router-link&apos;, &#123;</div><div class="line">            props: &#123;</div><div class="line">                to: String</div><div class="line">            &#125;,</div><div class="line">            render(h) &#123;</div><div class="line">                // h(tag, data, children)</div><div class="line">                return h(&apos;a&apos;, &#123; attrs: &#123;href: &apos;#&apos; + this.to&#125;&#125;, [this.$slots.default]);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        Vue.component(&apos;router-view&apos;, &#123;</div><div class="line">            render: (h) =&gt; &#123;</div><div class="line">                const component = this.routeMap[this.app.current].component;</div><div class="line">                return h(component);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 实现插件</div><div class="line">// 插件接收Vue构造函数</div><div class="line">VueRouter.install = function(_Vue) &#123;</div><div class="line">    Vue = _Vue;</div><div class="line">    // 混入：执行挂载操作</div><div class="line">    Vue.mixin(&#123;</div><div class="line">        beforeCreate() &#123;</div><div class="line">            if (this.$options.router) &#123;</div><div class="line">                Vue.prototype.$router = this.$options.router;</div><div class="line">                // 执行初始化</div><div class="line">                this.$options.router.init();</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">export default VueRouter;</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/24/deep-copy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/24/deep-copy/" itemprop="url">js中的浅拷贝和深拷贝</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-24T00:18:23+08:00">
                2017-09-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>举个例子来说明一下什么是浅拷贝什么是深拷贝</p>
<h3 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var x = &#123;</div><div class="line">    a: 1,</div><div class="line">    b: &#123;f: &#123;</div><div class="line">        g: 1</div><div class="line">    &#125;&#125;,</div><div class="line">    c: [1, 2, 3]</div><div class="line">&#125;;</div><div class="line">var y = shallow(x);</div></pre></td></tr></table></figure>
<p>得出的结果可以看出是浅拷贝</p>
<ul>
<li>非对象的属性值一个改变不影响另一个的值</li>
<li>对象属性是引用赋值所以一个改变会影响另一个的改变</li>
</ul>
<p>出现这种情况的本质是：对象是按引用赋值的<br><img src="http://note.youdao.com/yws/public/resource/6488981a2c836f0072e7501b62423505/xmlnote/8FE876EF30C44ECD9DEB4CC5EDD46ABC/12684" alt="image"></p>
<h3 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h3><p>指的是拷贝一个对象，改变一个值不影响另一个的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">// 实现深复制功能</div><div class="line">// 判断：1.是否是对象 2.是否是函数</div><div class="line">function deepCopy (obj, isDeep) &#123;</div><div class="line">    if (!_.isObject(obj)) &#123;</div><div class="line">        return obj</div><div class="line">    &#125; else &#123;</div><div class="line">        if (_.isFunction(obj)) &#123;</div><div class="line">            return new Function(&quot;return &quot; + obj.toString())();</div><div class="line">        &#125; else &#123;</div><div class="line">            var name,</div><div class="line">                target = _.isArray(obj) ? [] : &#123;&#125;,</div><div class="line">                value;</div><div class="line">            for (name in obj) &#123;</div><div class="line">                value = obj[name];</div><div class="line"></div><div class="line">                // 是浅拷贝还是深拷贝</div><div class="line">                if (isDeep &amp;&amp; (_.isArray(value) || _.isObject(value))) &#123;</div><div class="line">                    console.log(&apos;深拷贝&apos;);</div><div class="line">                    target[name] = deepCopy(value, isDeep);</div><div class="line">                &#125; else &#123;</div><div class="line">                    console.log(&apos;浅拷贝&apos;);</div><div class="line">                    target[name] = value</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            return target;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var array3 = &#123;</div><div class="line">    a: 1,</div><div class="line">    b: &#123;f: &#123;</div><div class="line">        g: 1</div><div class="line">    &#125;&#125;,</div><div class="line">    c: function () &#123;</div><div class="line">        console.log(&apos;is function&apos;);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">var array4 = deepCopy(array3, false);</div></pre></td></tr></table></figure>
<p><img src="http://note.youdao.com/yws/public/resource/6488981a2c836f0072e7501b62423505/xmlnote/2708341734564BED96D4535FD85942E6/12697" alt="image"></p>
<h3 id="一个技巧"><a href="#一个技巧" class="headerlink" title="一个技巧"></a>一个技巧</h3><p>使用JSON对象的parse()和stringify()方法</p>
<ul>
<li>pares() JSON字符串转成js对象</li>
<li>stringify() 将js对象转成JSON字符串<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//例1</div><div class="line">var source = &#123; name:&quot;source&quot;, child:&#123; name:&quot;child&quot; &#125; &#125; </div><div class="line">var target = JSON.parse(JSON.stringify(source));</div><div class="line">target.name = &quot;target&quot;;  //改变target的name属性</div><div class="line">console.log(source.name); //source </div><div class="line">console.log(target.name); //target</div><div class="line"></div><div class="line">//例2</div><div class="line">var source = &#123; name:function()&#123;console.log(1);&#125;, child:&#123; name:&quot;child&quot; &#125; &#125; </div><div class="line">var target = JSON.parse(JSON.stringify(source));</div><div class="line">console.log(target.name); //undefined</div></pre></td></tr></table></figure>
</li>
</ul>
<p>这种方法有局限性：</p>
<ul>
<li>对于正则表达式类型、函数类型等无法进行深拷贝(而且会直接丢失相应的值)</li>
<li>它会抛弃对象的constructor，不管这个对象原来的构造函数是什么，在深拷贝之后都会变成Object</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://lodashjs.com/docs/#_isarrayvalue" target="_blank" rel="external">lodash一些功能函数的使用</a></li>
<li><a href="https://github.com/wengjq/Blog/issues/3" target="_blank" rel="external">github js中浅拷贝和深拷贝的实现</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/31/cordova-ios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/31/cordova-ios/" itemprop="url">Cordova ios开发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-31T11:21:23+08:00">
                2017-08-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">ios</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://cordova.axuer.com/" target="_blank" rel="external">中文官方文档</a></p>
<p>cordova架构机制图：</p>
<p><img src="http://cordova.axuer.com/static/img/guide/cordovaapparchitecture.png" alt="images"></p>
<h2 id="构建一个ios-App"><a href="#构建一个ios-App" class="headerlink" title="构建一个ios App"></a>构建一个ios App</h2><p>全局安装cordova</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g cordova</div></pre></td></tr></table></figure>
<p>创建项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 生成基于web应用程序的骨架，项目主页www/index.html</div><div class="line">cordova create MyApp</div></pre></td></tr></table></figure>
<p>进入项目添加平台</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd MyApp</div><div class="line">cordova platform add ios</div></pre></td></tr></table></figure>
<p>运行App</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cordova run ios</div></pre></td></tr></table></figure>
<h3 id="构建app"><a href="#构建app" class="headerlink" title="构建app"></a>构建app</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cordova build ios</div><div class="line">cordova requirements // 检测你是否满足构建平台的要求</div></pre></td></tr></table></figure>
<h3 id="安装cocoapods"><a href="#安装cocoapods" class="headerlink" title="安装cocoapods"></a>安装cocoapods</h3><p>遇到各种问题，发现stackflow很管用</p>
<p><a href="http://www.jianshu.com/p/1711e131987d" target="_blank" rel="external">http://www.jianshu.com/p/1711e131987d</a> 安装和使用教程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo gem install cocoapods -V // V可以查看下载的进程</div><div class="line">pod setup</div></pre></td></tr></table></figure></p>
<h2 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h2><p>想把本地应用安装到我手机上，显示各种报错安装不了</p>
<p><strong>mac系统版本10.11.6 Xcode 7.3.4 iphone7 10.3.2</strong></p>
<p>首先要有ios开发者账号，找朋友要了一个按照他给的文档操作，先添加证书（前提是让他把我的手机Uuid让他添加到他的ios账号上去）</p>
<p>然后还是不行，发现原来是xcode版本没有我手机真机调试包，最高才9.3的版本，于是又开始各种升级</p>
<p>现在<strong>mac统版本10.12.5 xcode8.3.3 iphone7 10.3.2</strong>安装各种慢慢慢</p>
<p>然后要在手机设置允许下载应用：设置-通用-描述文件与设备管理-允许</p>
<p>添加真机调试包的地址：<br>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport**</p>
<h3 id="打包运行app"><a href="#打包运行app" class="headerlink" title="打包运行app"></a>打包运行app</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm run build // 本地单页项目地址执行</div><div class="line">cordova run ios // 运行app指定平台</div></pre></td></tr></table></figure>
<p>在xcode运行查看项目，需要ios开发者账号和证书</p>
<h2 id="在真机上打包"><a href="#在真机上打包" class="headerlink" title="在真机上打包"></a>在真机上打包</h2><p><a href="http://www.cnblogs.com/czq1989/p/4919457.html" target="_blank" rel="external">http://www.cnblogs.com/czq1989/p/4919457.html</a> app打包流程</p>
<p>打包：将应用程序统一放在一个后缀是ipa的文件中，然后发给其他人，可以安装在手机上供用户或测试人员安装</p>
<p>可安装ipa的前提：</p>
<ul>
<li>说清楚是哪一个应用程序（App Id）</li>
<li>可以安装在哪一台设备上（UDID）</li>
</ul>
<p>打包过程：</p>
<ol>
<li>在本地生成csr文件</li>
<li>进入开发者中心 apple developer</li>
<li>选择Ad Hoc生成一个iOS_distribution.cer证书，此证书是为了限定哪台电脑可以打包生成ipa</li>
<li>新建一个App Id，此ID用于限定要打包的应用程序的Bundle Id是什么，这次不能写*这样的范围匹配，必须写一个准确的App Id</li>
<li>注册要安装ipa文件的设备的UDID</li>
<li>选择Ad Hoc，利用iOS_distribution.cer文件 + 设备UDID + App Id生成一个provision文件</li>
<li>将证书安装到电脑上</li>
<li>保证xcode的配置一致</li>
<li>将ipa拷贝给要安装的人，此人打开iTunes，点击应用程序，再双击ipa，点击安装，点击同步即可</li>
</ol>
<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><h4 id="相关证书和配置文件说明："><a href="#相关证书和配置文件说明：" class="headerlink" title="相关证书和配置文件说明："></a>相关证书和配置文件说明：</h4><p><a href="http://www.cocoachina.com/ios/20160104/14859.html" target="_blank" rel="external">理清各种证书的关系和原理</a></p>
<p><img src="http://note.youdao.com/yws/public/resource/91a7a76c69320c69abf977223850fe69/xmlnote/WEBRESOURCEeba675f594aba7dece7a218d2ee77550/11477" alt="image"></p>
<h4 id="将手机连接mac电脑在自己手机上打包测试"><a href="#将手机连接mac电脑在自己手机上打包测试" class="headerlink" title="将手机连接mac电脑在自己手机上打包测试"></a>将手机连接mac电脑在自己手机上打包测试</h4><ul>
<li>方法1: 直接通过绑定开发者账号</li>
</ul>
<p><img src="http://note.youdao.com/yws/public/resource/91a7a76c69320c69abf977223850fe69/xmlnote/WEBRESOURCE545112a7bdee410d6709abbc5322ca31/11447" alt="image"></p>
<ul>
<li>方法2:通过开发者账号配置的配置文件带有后缀provision</li>
</ul>
<p><img src="http://note.youdao.com/yws/public/resource/91a7a76c69320c69abf977223850fe69/xmlnote/WEBRESOURCEf46182b0fa018685ba5b8a4dc6d377be/11450" alt="images"></p>
<p><img src="http://note.youdao.com/yws/public/resource/91a7a76c69320c69abf977223850fe69/xmlnote/WEBRESOURCEdb845a8b68ab015d5f2de6433b4102cc/11457" alt="images"></p>
<p>操作：</p>
<ul>
<li>点击证书，输入p12密码文件中的密码</li>
<li>根据截图填写相关信息</li>
<li>导入配置文件</li>
</ul>
<h2 id="打包上线到appstore"><a href="#打包上线到appstore" class="headerlink" title="打包上线到appstore"></a>打包上线到appstore</h2><p>上线流程：</p>
<ol>
<li>创建App IDs和Boudle ID</li>
<li>创建发布证书（若已创建过发布证书，现在用的是p12文件，可直接跳到第21步）</li>
<li>创建本地证书</li>
<li>创建Provisiong Profiles文件 （测试：在xcode中要添加的证书文件，包括允许访问的设备；发布：选择app store ）</li>
<li>在app store开辟空间 iTunes Connect</li>
<li>在Xcode中打包工程</li>
</ol>
<p><a href="http://www.jianshu.com/p/06c3c1b0bf9b" target="_blank" rel="external">http://www.jianshu.com/p/06c3c1b0bf9b</a> ios app上线流程详解</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/15/js-ajax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/15/js-ajax/" itemprop="url">Ajax</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-15T23:51:52+08:00">
                2017-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="手动编写一个ajax-不依赖第三方库-理解每一步"><a href="#手动编写一个ajax-不依赖第三方库-理解每一步" class="headerlink" title="手动编写一个ajax,不依赖第三方库 理解每一步"></a>手动编写一个ajax,不依赖第三方库 理解每一步</h3><h4 id="ajax请求"><a href="#ajax请求" class="headerlink" title="ajax请求"></a>ajax请求</h4><p>一个完整的ajax请求一般包括以下步骤：</p>
<ul>
<li>实例化XMLHttpRequest对象</li>
<li>连接服务器</li>
<li>发送请求</li>
<li>接收响应数据</li>
</ul>
<p>http相关状态码</p>
<ul>
<li>200 ok 访问正常</li>
<li>301 Moved Permanently 永久移动</li>
<li>302 Move Temporarity 暂时移动</li>
<li>304 Not Modified 未修改</li>
<li>307 Temporary Redirect 暂时重定向</li>
<li>401 Unauthorized 未授权</li>
<li>403 Forbidden 禁止访问</li>
<li>404 Not Found 未发现指定网址</li>
<li>500 Internal Server Error 服务期发生错误<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line">function ajax (params) &#123;</div><div class="line">    params = params || &#123;&#125;;</div><div class="line">    // 1.实例化XMLHttpRequest对象</div><div class="line">    var xhr = new XMLHttpRequest();</div><div class="line">    // 2.连接服务器open()&amp;3.发送请求send()</div><div class="line">    if (params.type == &apos;GET&apos;) &#123;</div><div class="line">        xhr.open(params.type, params.url + &apos;?&apos; + params.data, true);</div><div class="line">        xhr.send(null);</div><div class="line">    &#125; else &#123;</div><div class="line">        xhr.open(params.type, params.url, true);</div><div class="line">        xhr.setRequestHeader(&apos;Content-Type&apos;, &apos;application/x-www-form-urlencoded; charset=UTF-8&apos;);</div><div class="line">        xhr.send(params.data);</div><div class="line">    &#125;</div><div class="line">    // 4.接收响应数据</div><div class="line">    xhr.onreadystatechange = function () &#123;</div><div class="line">        var response = &apos;&apos;;</div><div class="line">        if (xhr.readyState == 4) &#123;</div><div class="line">            response = xhr.responseText;</div><div class="line">            // 5.根据响应结果执行不同的操作</div><div class="line">            if (xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300 || xhr.status == 304) &#123;</div><div class="line">                //5-1响应成功</div><div class="line">                params.success &amp;&amp; params.success(response);</div><div class="line">            &#125; else &#123;</div><div class="line">//                    alert(xhr.status);</div><div class="line">                //5-2响应失败</div><div class="line">                params.error &amp;&amp; params.error(xhr.status);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    // 给url添加参数.因为查询字符串每个参数的名称和值都必须</div><div class="line">    // 使用encodeURIComponent()进行编码才能放到URL的末尾</div><div class="line">    // 而且所有名-值对都必须有&amp;分隔</div><div class="line">    // xhr.open(&quot;get&quot;, &quot;example.php?name1=value1&amp;name2=value2&quot;, true);</div><div class="line">    function addURLParams (url, name, value) &#123;</div><div class="line">        url += (url.indexOf(&quot;?&quot;) == -1 ? &quot;?&quot; : &quot;&amp;&quot;);</div><div class="line">        url += encodeURIComponent(name) + &quot;=&quot; + encodeURIComponent(value);</div><div class="line">        return url;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// 调用</div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;https://www.youtube.com/watch?v=Ucbp-Ej5RpI&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;1&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, Math.random(), &apos;1&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;test.json&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;2&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, Math.random(), &apos;2&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="解决跨域"><a href="#解决跨域" class="headerlink" title="解决跨域"></a>解决跨域</h3><h4 id="跨域的几种实现方式（ajax不能跨域）"><a href="#跨域的几种实现方式（ajax不能跨域）" class="headerlink" title="跨域的几种实现方式（ajax不能跨域）"></a>跨域的几种实现方式（ajax不能跨域）</h4><ol>
<li>通过跨域标签</li>
</ol>
<ul>
<li>script标签</li>
<li>link标签</li>
<li>img标签 图片防盗链，知乎做了</li>
</ul>
<ol>
<li>服务器端设置http header</li>
</ol>
<ul>
<li>另一个解决跨域的简洁方法,需要服务器端来做</li>
<li>但是作为交互房,我们必须知道这个方法</li>
<li>是将来解决跨域问题的一个趋势<h4 id="什么是跨域"><a href="#什么是跨域" class="headerlink" title="什么是跨域?"></a>什么是跨域?</h4>浏览器有同源策略,不允许ajax访问其他域的接口 接口的安全性(人家的接口怎么能让你随便访问的)<h4 id="跨域条件"><a href="#跨域条件" class="headerlink" title="跨域条件"></a>跨域条件</h4>协议 域名 端口 有一个不同就算跨域</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">http://www.yeeduo.com/index.html </div><div class="line">http://www.xitalk.com/index.html // 域名不同</div><div class="line">http://www.yeeduo.com:8888/index.html // 端口不同</div><div class="line">https://www.yeeduo.com/index.html // 协议不同</div></pre></td></tr></table></figure>
<h4 id="jsonp实现原理"><a href="#jsonp实现原理" class="headerlink" title="jsonp实现原理"></a>jsonp实现原理</h4><p><strong>请求时服务器可以返回动态的内容 然后拼接成js文件通过script标签引入</strong></p>
<h5 id="请求过程"><a href="#请求过程" class="headerlink" title="请求过程:"></a>请求过程:</h5><ul>
<li>请求阶段: 浏览器创建一个script标签,并给其src赋值(类似<a href="http://example.com/api/?callback=jsonpCallback" target="_blank" rel="external">http://example.com/api/?callback=jsonpCallback</a>)</li>
<li>发送请求: 当给script的s4c赋值时,浏览器会发起一个请求</li>
<li>数据响应: 服务器将要返回的数据作为参数和函数名称拼接在一起(格式类似”jsonpCallback({name: ‘abc’})”)返回.</li>
<li>当浏览器接受到了响应数据,由于发起请求的是script,所以相当于直接调用jsonpCallback方法,并且传入了一个参数 why?</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">// 6.解决跨域的问题 浏览器同源策略</div><div class="line">function jsonp (params) &#123;</div><div class="line">    // a.将请求插入动态创建生成的script标签</div><div class="line">    var script = document.createElement(&apos;script&apos;);</div><div class="line">    var head = document.getElementsByTagName(&apos;head&apos;)[0];</div><div class="line">    head.appendChild(script);</div><div class="line">    // 设置传递给后台的回调参数名</div><div class="line">    var callbackName = params.jsonp;</div><div class="line">    params.data[&apos;callback&apos;] = callbackName; // ?callback=jsonpCallback</div><div class="line"></div><div class="line">    // b.创建回调</div><div class="line">    window[callbackName] = function (json) &#123;</div><div class="line">        head.removeChild(script);</div><div class="line">        clearTimeout(script.timer);</div><div class="line">        window[callbackName] = null;</div><div class="line">        params.success &amp;&amp; params.success(json);</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    // c.发送请求</div><div class="line">    script.src = params.url + &apos;?&apos; + data;</div><div class="line"></div><div class="line">    // d.设置超时处理,为了得知此次请求是否成功</div><div class="line">    if (params.time) &#123;</div><div class="line">        script.timer = setTimeout(function () &#123;</div><div class="line">            window[callbackName] = null;</div><div class="line">            head.removeChild(script);</div><div class="line">            params.error &amp;&amp; params.error(&#123;</div><div class="line">                message: &apos;超时&apos;</div><div class="line">            &#125;);</div><div class="line">        &#125;, params.time);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 格式化参数</div><div class="line">function formatParams (data) &#123;</div><div class="line">    var arr = [];</div><div class="line">    for (var name in data) &#123;</div><div class="line">       arr.push(encodeURIComponent(name) + &apos;=&apos; + encodeURIComponent(data[name]));</div><div class="line">    &#125;</div><div class="line">    // 添加一个随机数,防止缓存</div><div class="line">    arr.push(&apos;v=&apos; + random());</div><div class="line">    return arr.join(&apos;&amp;&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 获取随机数</div><div class="line">function random () &#123;</div><div class="line">    return Math.floor(Math.random() * 10000 + 500);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 调用</div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;test.json&apos;,</div><div class="line">    jsonp: &apos;jsonCallback&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;2&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, &apos;2&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>参考文章：<a href="https://juejin.im/entry/589921640ce46300560ef894原生js实现ajax、jsonp" target="_blank" rel="external">https://juejin.im/entry/589921640ce46300560ef894原生js实现ajax、jsonp</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div></pre></td><td class="code"><pre><div class="line">function ajax (params) &#123;</div><div class="line">    params = params || &#123;&#125;;</div><div class="line">    params.data = params.data || &#123;&#125;;</div><div class="line">    var json = params.jsonp ? jsonp(params) : json(params);</div><div class="line"></div><div class="line">    function json (params) &#123;</div><div class="line">        // 请求方式,默认是GET</div><div class="line">        params.type = (params.type || &apos;GET&apos;).toUpperCase(); // 转换成大写,请求类型</div><div class="line">        // 避免有特殊字符,必须格式化传输数据</div><div class="line">        params.data = formatParams(params.data); // 数据</div><div class="line">        var xhr = null;</div><div class="line"></div><div class="line">        // 1.实例化XMLHttpRequest对象</div><div class="line">        var xhr = new XMLHttpRequest();</div><div class="line">        // 2.连接服务器open()&amp;3.发送请求send()</div><div class="line">        if (params.type == &apos;GET&apos;) &#123;</div><div class="line">            xhr.open(params.type, params.url + &apos;?&apos; + params.data, true);</div><div class="line">            xhr.send(null);</div><div class="line">        &#125; else &#123;</div><div class="line">            xhr.open(params.type, params.url, true);</div><div class="line">            xhr.setRequestHeader(&apos;Content-Type&apos;, &apos;application/x-www-form-urlencoded; charset=UTF-8&apos;);</div><div class="line">            xhr.send(params.data);</div><div class="line">        &#125;</div><div class="line">        // 4.接收响应数据</div><div class="line">        xhr.onreadystatechange = function () &#123;</div><div class="line">            if (xhr.readyState == 4) &#123;</div><div class="line">                // 5.根据响应结果执行不同的操作</div><div class="line">                if (xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300 || xhr.status == 304) &#123;</div><div class="line">                    var response = &apos;&apos;;</div><div class="line">                    // 判断接受数据的内容类型</div><div class="line">                    var type = xhr.getResponseHeader(&apos;Content-type&apos;);</div><div class="line">                    if(type.indexOf(&apos;xml&apos;) !== -1 &amp;&amp; xhr.responseXML) &#123;</div><div class="line">                        response = xhr.responseXML; //Document对象响应</div><div class="line">                    &#125; else if(type === &apos;application/json&apos;) &#123;</div><div class="line">//                            alert(&apos;json格式&apos;)</div><div class="line">                        response = JSON.parse(xhr.responseText); //JSON响应</div><div class="line">                    &#125; else &#123;</div><div class="line">                        response = xhr.responseText; //字符串响应</div><div class="line">                    &#125;</div><div class="line">                    //5-1响应成功</div><div class="line">                    params.success &amp;&amp; params.success(response);</div><div class="line">                &#125; else &#123;</div><div class="line">//                    alert(xhr.status);</div><div class="line">                    //5-2响应失败</div><div class="line">                    params.error &amp;&amp; params.error(xhr.status);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 6.解决跨域的问题 浏览器同源策略</div><div class="line">    function jsonp (params) &#123;</div><div class="line">        // a.将请求插入动态创建生成的script标签</div><div class="line">        var script = document.createElement(&apos;script&apos;);</div><div class="line">        var head = document.getElementsByTagName(&apos;head&apos;)[0];</div><div class="line">        head.appendChild(script);</div><div class="line">        // 设置传递给后台的回调参数名</div><div class="line">        var callbackName = params.jsonp;</div><div class="line">        params.data[&apos;callback&apos;] = callbackName; // ?callback=jsonpCallback</div><div class="line"></div><div class="line">        // b.创建回调</div><div class="line">        window[callbackName] = function (json) &#123;</div><div class="line">            head.removeChild(script);</div><div class="line">            clearTimeout(script.timer);</div><div class="line">            window[callbackName] = null;</div><div class="line">            params.success &amp;&amp; params.success(json);</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        // c.发送请求</div><div class="line">        script.src = params.url + &apos;?&apos; + params.data;</div><div class="line"></div><div class="line">        // d.设置超时处理,为了得知此次请求是否成功</div><div class="line">        if (params.time) &#123;</div><div class="line">            script.timer = setTimeout(function () &#123;</div><div class="line">                window[callbackName] = null;</div><div class="line">                head.removeChild(script);</div><div class="line">                params.error &amp;&amp; params.error(&#123;</div><div class="line">                    message: &apos;超时&apos;</div><div class="line">                &#125;);</div><div class="line">            &#125;, params.time);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 格式化参数</div><div class="line">    function formatParams (data) &#123;</div><div class="line">        var arr = [];</div><div class="line">        for (var name in data) &#123;</div><div class="line">           arr.push(encodeURIComponent(name) + &apos;=&apos; + encodeURIComponent(data[name]));</div><div class="line">        &#125;</div><div class="line">        // 添加一个随机数,防止缓存</div><div class="line">        arr.push(&apos;v=&apos; + random());</div><div class="line">        return arr.join(&apos;&amp;&apos;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 获取随机数</div><div class="line">    function random () &#123;</div><div class="line">        return Math.floor(Math.random() * 10000 + 500);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    // 给url添加参数.因为查询字符串每个参数的名称和值都必须</div><div class="line">    // 使用encodeURIComponent()进行编码才能放到URL的末尾</div><div class="line">    // 而且所有名-值对都必须有&amp;分隔</div><div class="line">    // xhr.open(&quot;get&quot;, &quot;example.php?name1=value1&amp;name2=value2&quot;, true);</div><div class="line">    function addURLParams (url, name, value) &#123;</div><div class="line">        url += (url.indexOf(&quot;?&quot;) == -1 ? &quot;?&quot; : &quot;&amp;&quot;);</div><div class="line">        url += encodeURIComponent(name) + &quot;=&quot; + encodeURIComponent(value);</div><div class="line">        return url;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;https://www.youtube.com/watch?v=Ucbp-Ej5RpI&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;1&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, Math.random(), &apos;1&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;test.json&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;2&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, Math.random(), &apos;2&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">ajax(&#123;</div><div class="line">    url: &apos;test.php&apos;,</div><div class="line">    jsonp: &apos;jsonCallback&apos;,</div><div class="line">    type: &apos;GET&apos;,</div><div class="line">    data: &#123;</div><div class="line">        &apos;b&apos;: &apos;异步请求&apos;</div><div class="line">    &#125;,</div><div class="line">    success: function (res) &#123;</div><div class="line">        console.log(res, &apos;2&apos;);</div><div class="line">    &#125;,</div><div class="line">    error: function (error) &#123;</div><div class="line">        console.log(error, Math.random(), &apos;2&apos;)</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/05/event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/05/event/" itemprop="url">事件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-05T22:20:27+08:00">
                2017-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://note.youdao.com/noteshare?id=12bcb607130da35044660ab0442f8666" target="_blank" rel="external">事件相关基础知识</a></p>
<h3 id="一个事件执行的过程"><a href="#一个事件执行的过程" class="headerlink" title="一个事件执行的过程"></a>一个事件执行的过程</h3><p>事件冒泡<br><img src="http://note.youdao.com/yws/public/resource/12bcb607130da35044660ab0442f8666/xmlnote/WEBRESOURCE3627b94721f531f351b06a3435861d34/4065" alt="image"><br>事件捕获<br><img src="http://note.youdao.com/yws/public/resource/12bcb607130da35044660ab0442f8666/xmlnote/WEBRESOURCEfc02c6456f801b4cc91e95f50a37169c/4064" alt="image"></p>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><h4 id="一、编写一个通用的事件监听函数"><a href="#一、编写一个通用的事件监听函数" class="headerlink" title="一、编写一个通用的事件监听函数"></a>一、编写一个通用的事件监听函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">function addEvent (element, type, selector, fn) &#123; // selector是否使用代理</div><div class="line">    if (fn == null) &#123;</div><div class="line">        fn = selector;</div><div class="line">        selector = null;</div><div class="line">    &#125;</div><div class="line">    if (element.addEventListener) &#123;</div><div class="line">        element.addEventListener(type, function (e) &#123;</div><div class="line">            var target;</div><div class="line">            if (selector) &#123;</div><div class="line">                target = e.target;</div><div class="line">                if (target.matches(selector)) &#123;</div><div class="line">                    fn.call(target, e);</div><div class="line">                &#125;</div><div class="line">            &#125; else &#123;</div><div class="line">                fn(e);</div><div class="line">            &#125;</div><div class="line">        &#125;, false);</div><div class="line">    &#125; else if (element.attachEvent) &#123;</div><div class="line">        element.attachEvent(&apos;on&apos; + type, fn);</div><div class="line">    &#125; else &#123;</div><div class="line">        element[&apos;on&apos;+type] = fn;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">function removeEvent (element, type, fn) &#123;</div><div class="line">    if (element.removeEventListener) &#123;</div><div class="line">        element.removeEventListener(type, fn, false);</div><div class="line">    &#125; else if (element.detachEvent) &#123;</div><div class="line">        element.detachEvent(&apos;on&apos; + type, fn);</div><div class="line">    &#125; else &#123;</div><div class="line">        element[&apos;on&apos; + type] = null;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="二、描述事件冒泡的过程"><a href="#二、描述事件冒泡的过程" class="headerlink" title="二、描述事件冒泡的过程"></a>二、描述事件冒泡的过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">// DOM2级事件规定事件流包括: 事件捕获, 处于目标阶段, 事件冒泡</div><div class="line">// 事件处理程序的几种方式:</div><div class="line">// a. HTML事件处理程序 直接将js代码写在HTML元素on+type绑定事件里</div><div class="line">// b. DOM0级事件处理程序</div><div class="line">// c. DOM2级事件处理程序</div><div class="line">// d.IE事件处理程序</div><div class="line"></div><div class="line">// 事件冒泡主要考察</div><div class="line">// DOM树形结构</div><div class="line">// 事件冒泡</div><div class="line">// 阻止冒泡</div><div class="line">// 冒泡的应用--代理</div><div class="line"></div><div class="line">&lt;div id=&quot;div1&quot;&gt;</div><div class="line">    &lt;p id=&quot;p1&quot;&gt;激活&lt;/p&gt;</div><div class="line">    &lt;p id=&quot;p2&quot;&gt;取消&lt;/p&gt;</div><div class="line">    &lt;p id=&quot;p3&quot;&gt;取消&lt;/p&gt;</div><div class="line">    &lt;p id=&quot;p4&quot;&gt;取消&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div id=&quot;div2&quot;&gt;</div><div class="line">    &lt;p id=&quot;p5&quot;&gt;取消&lt;/p&gt;</div><div class="line">    &lt;p id=&quot;p6&quot;&gt;取消&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">// 点击取消时冒泡到body,点击激活时阻止冒泡</div><div class="line">var p1 = document.getElementById(&apos;p1&apos;);</div><div class="line">var body = document.body;</div><div class="line">addEvent(p1, &apos;click&apos;, function (e) &#123;</div><div class="line">    e.stopPropagation(); // 取消冒泡</div><div class="line">    console.log(&apos;激活&apos;);</div><div class="line">&#125;);</div><div class="line">addEvent(body, &apos;click&apos;, function () &#123;</div><div class="line">    console.log(&apos;取消&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="三、对于一个无限下拉加载图片的页面，如何给每个图片绑定事件"><a href="#三、对于一个无限下拉加载图片的页面，如何给每个图片绑定事件" class="headerlink" title="三、对于一个无限下拉加载图片的页面，如何给每个图片绑定事件"></a>三、对于一个无限下拉加载图片的页面，如何给每个图片绑定事件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">// 原理: 1.事件冒泡 2.判断元素是否是指定元素 jquery的on方法</div><div class="line">// 代理的好处: 1.代码简洁 2.减少浏览器内存占用</div><div class="line">&lt;div id=&quot;div3&quot;&gt;</div><div class="line">    &lt;img src=&quot;01.jpg&quot; id=&quot;img1&quot;&gt;</div><div class="line">    &lt;img src=&quot;02.jpg&quot;&gt;</div><div class="line">    &lt;img src=&quot;03.jpg&quot;&gt;</div><div class="line">    &lt;img src=&quot;04.jpg&quot;&gt;</div><div class="line">    &lt;!-- 会随时新增更多 img 标签--&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">var div3 = document.getElementById(&apos;div3&apos;);</div><div class="line">// 使用代理</div><div class="line">addEvent(div3, &apos;click&apos;, &apos;img&apos;, function (e) &#123;</div><div class="line">    alert(this.innerHTML);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//不适用代理</div><div class="line">var img = document.getElementById(&apos;img1&apos;);</div><div class="line">addEvent(div3, &apos;click&apos;, function () &#123;</div><div class="line">    console.log(img.src);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/30/dom-and-bom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Hayley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hayley's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/30/dom-and-bom/" itemprop="url">DOM和BOM知识总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-30T22:15:51+08:00">
                2017-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="前言：从js基础知识过渡到JS-Web-API"><a href="#前言：从js基础知识过渡到JS-Web-API" class="headerlink" title="前言：从js基础知识过渡到JS-Web-API"></a>前言：从js基础知识过渡到JS-Web-API</h3><ul>
<li>JS基础知识：ECMA 262标准</li>
<li>JS-Web-API：W3C标准，与浏览器有关</li>
<li>浏览器要运行js代码要遵守以上两种标准</li>
</ul>
<p>全面考虑，JS内置的全局函数和对象有哪些？</p>
<ul>
<li>Object Array Boolean String Math JSON等</li>
</ul>
<h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3><blockquote>
<p>Document Object Model 文档对象模型</p>
</blockquote>
<p><strong>DOM的本质</strong>：浏览器把拿到的html代码，结构化一个浏览器能识别并且可操作的一个模型而已</p>
<h4 id="1-DOM是哪种基本的数据结构？"><a href="#1-DOM是哪种基本的数据结构？" class="headerlink" title="1.DOM是哪种基本的数据结构？"></a>1.DOM是哪种基本的数据结构？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 树 html是xml的一种特殊类型 有规则结构化的东西浏览器比较好处理</div><div class="line">// 字符串结构化成html,html本质其实是字符串</div></pre></td></tr></table></figure>
<h4 id="2-DOM操作的常用API有哪些？"><a href="#2-DOM操作的常用API有哪些？" class="headerlink" title="2.DOM操作的常用API有哪些？"></a>2.DOM操作的常用API有哪些？</h4><p>获取DOM节点，以及节点的property和Attribute<br>获取父节点，获取子节点<br>新增节点，删除节点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">// DOM结构操作 DOM树</div><div class="line">// 1.新增节点</div><div class="line">// a.增加新节点 createElement</div><div class="line">var child = document.createElement(&apos;p&apos;);</div><div class="line">div.appendChild(child);</div><div class="line">// b.移动已有节点，原来的位置将不会再有被移动的元素</div><div class="line">var div2 = document.getElementById(&apos;div2&apos;);</div><div class="line">var div1 = document.getElementById(&apos;div1&apos;);</div><div class="line">div1.appendChild(div2);</div><div class="line"></div><div class="line">// 2.获取父元素parentElement和子元素childNodes</div><div class="line">console.log(child.parentElement); // div1</div><div class="line">console.log(div1.childNodes); // text,p div2子节点集合</div><div class="line">console.log(div1.childNodes[0].nodeType); // text 3</div><div class="line">console.log(div1.childNodes[0].nodeName); // text #text</div><div class="line">console.log(div1.childNodes[1].nodeType); // p 1</div><div class="line">console.log(div1.childNodes[1].nodeName); // p P</div><div class="line">console.log(div1.childNodes[2].nodeType); // div 1</div><div class="line"></div><div class="line">// 3.删除</div><div class="line">div1.removeChild(div1.childNodes[0]);</div></pre></td></tr></table></figure>
<h4 id="3-DOM节点的attr和property有何区别？"><a href="#3-DOM节点的attr和property有何区别？" class="headerlink" title="3.DOM节点的attr和property有何区别？"></a>3.DOM节点的attr和property有何区别？</h4><ul>
<li>property 只是一个js对象的属性的修改 obj.property</li>
<li>Attribute 是对html标签属性的修改 p.attribute</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// DOM节点操作</div><div class="line">// property 只是一个js对象的属性的修改 obj.property</div><div class="line">var divList = document.querySelectorAll(&apos;div&apos;); // 集合</div><div class="line">var div = divList[0]; // div是节点对象</div><div class="line">console.log(div.style.width); // 获取样式 // 空</div><div class="line">div.style.width = &apos;100px&apos;; // 修改样式</div><div class="line">console.log(div.className); // 获取样式 // 空</div><div class="line">div.className = &apos;div1&apos;; // 设置样式</div><div class="line"></div><div class="line">// 获取nodeName和nodeType</div><div class="line">console.log(div.nodeName); // DIV</div><div class="line">console.log(div.nodeType); // 1</div></pre></td></tr></table></figure>
<h3 id="DOM知识点总结："><a href="#DOM知识点总结：" class="headerlink" title="DOM知识点总结："></a>DOM知识点总结：</h3><ul>
<li>DOM本质</li>
<li>DOM节点操作</li>
<li>DOM结构操作</li>
</ul>
<h3 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a>BOM</h3><blockquote>
<p>Browser Object Model 浏览器对象模型</p>
</blockquote>
<h4 id="3-1-如何检测浏览器的类型"><a href="#3-1-如何检测浏览器的类型" class="headerlink" title="3 1.如何检测浏览器的类型"></a>3 1.如何检测浏览器的类型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">//navigator.userAgent 区分浏览器（不能100%区分）</div></pre></td></tr></table></figure>
<h4 id="2-拆解url的各部分"><a href="#2-拆解url的各部分" class="headerlink" title="2.拆解url的各部分"></a>2.拆解url的各部分</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// location.protocol 协议</div><div class="line">// location.host 主机</div><div class="line">// location.pathname 具体路径</div><div class="line">// location.search ?号后面的查询部分</div><div class="line">// location.hash #号后面的哈希</div><div class="line">// location.href 完整地址</div></pre></td></tr></table></figure>
<h3 id="BOM知识点总结"><a href="#BOM知识点总结" class="headerlink" title="BOM知识点总结"></a>BOM知识点总结</h3><p>查看对象的属性和方法可以在浏览器打印出来</p>
<ul>
<li>navigator 浏览器</li>
<li>screen 屏幕</li>
<li>location 地址</li>
<li>history 历史</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Hayley" />
          <p class="site-author-name" itemprop="name">Hayley</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hayley</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
